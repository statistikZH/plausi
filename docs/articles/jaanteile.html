<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Vorhersage Ja-Anteile • plausi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Vorhersage Ja-Anteile">
<meta property="og:description" content="plausi">
<meta name="twitter:card" content="summary">
<meta name="theme-color" content="#293c55">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-7425245790017381",
          enable_page_level_ads: true
     });
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plausi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/jaanteile.html">Vorhersage Ja-Anteile</a>
    </li>
    <li>
      <a href="../articles/model_selection.html">model_selection</a>
    </li>
    <li>
      <a href="../articles/stimmbeteiligung.html">Auffällige Stimmbeteiligungswerte identifizieren</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="jaanteile_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Vorhersage Ja-Anteile</h1>
            
      
      
      <div class="hidden name"><code>jaanteile.Rmd</code></div>

    </div>

    
    
<p>Ein Glücksfall: stabiles Abstimmungsverhalten über die Zeit. Die ideologische Positionierung einer Gemeinde verändert sich nur sehr langsam. Daher können wir für einen Abstimmungssontag anhand der Daten der Vergangenheit Vorlagen identifizieren, welche ähnliche Zustimmungsmuster aufweisen und für die Gemeinden eine Vorhersage treffen und simulieren, was wir anhand der Vergangneheit erwarten würden.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">plausi</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="co">#&gt; -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</span>
<span class="co">#&gt; v ggplot2 3.3.2     v purrr   0.3.4</span>
<span class="co">#&gt; v tibble  3.0.2     v dplyr   1.0.0</span>
<span class="co">#&gt; v tidyr   1.1.0     v stringr 1.4.0</span>
<span class="co">#&gt; v readr   1.3.1     v forcats 0.5.0</span>
<span class="co">#&gt; -- Conflicts ------------------------------------------ tidyverse_conflicts() --</span>
<span class="co">#&gt; x dplyr::filter() masks stats::filter()</span>
<span class="co">#&gt; x dplyr::lag()    masks stats::lag()</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/politanch/swissdd">swissdd</a></span><span class="op">)</span>
<span class="co">#&gt; ************************************************************</span>
<span class="co">#&gt; *                       swissdd 1.0.3                      *</span>
<span class="co">#&gt; *                  developed by politan.ch                 *</span>
<span class="co">#&gt; *                                                          *</span>
<span class="co">#&gt; *                     Data sources:                        *</span>
<span class="co">#&gt; *                Federal Statistical Office                *</span>
<span class="co">#&gt; *                 https://www.bfs.admin.ch/                *</span>
<span class="co">#&gt; *                                                          *</span>
<span class="co">#&gt; *                      Swissvotes                          *</span>
<span class="co">#&gt; *                  https://swissvotes.ch/                  *</span>
<span class="co">#&gt; *                                                          *</span>
<span class="co">#&gt; ************************************************************</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://www.milbo.users.sonic.net/earth">earth</a></span><span class="op">)</span>
<span class="co">#&gt; Lade nötiges Paket: Formula</span>
<span class="co">#&gt; Lade nötiges Paket: plotmo</span>
<span class="co">#&gt; Lade nötiges Paket: plotrix</span>
<span class="co">#&gt; Lade nötiges Paket: TeachingDemos</span>

<span class="co"># BFS Nummern ausgewählter Gemeinden</span>
<span class="va">bfs_nrs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">7</span>,<span class="fl">10</span>,<span class="fl">11</span>,<span class="fl">12</span>,<span class="fl">87</span>,<span class="fl">219</span>,<span class="fl">294</span> ,<span class="fl">181</span>,<span class="fl">38</span>,<span class="fl">60</span>,<span class="fl">92</span>,<span class="fl">119</span>,<span class="fl">182</span>,<span class="fl">218</span><span class="op">)</span>


<span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html">Sys.setenv</a></span><span class="op">(</span>https_proxy<span class="op">=</span><span class="st">""</span><span class="op">)</span>
<span class="co"># Beziehe historische Daten</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu">swissdd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/swissdd/man/get_nationalvotes.html">get_nationalvotes</a></span><span class="op">(</span>from_date<span class="op">=</span><span class="st">"2017-03-01"</span>, to_date<span class="op">=</span><span class="st">"2020-09-27"</span><span class="op">)</span>

<span class="co"># Formattiere historische Daten um : eine Spalte je Vorlage</span>
<span class="va">testdata</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">canton_id</span><span class="op">==</span><span class="fl">1</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>id<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"v"</span>,<span class="va">id</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">jaStimmenInProzent</span>, <span class="va">id</span>, <span class="va">mun_id</span>, <span class="va">mun_name</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from<span class="op">=</span><span class="va">id</span>, values_from <span class="op">=</span> <span class="va">jaStimmenInProzent</span><span class="op">)</span> <span class="op">%&gt;%</span> 
 <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html">drop_na</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Trainingsdatensatz erstellen (nur ausgezählte Gemeinden)</span>
<span class="va">train</span> <span class="op">&lt;-</span> <span class="va">testdata</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html">vars</a></span><span class="op">(</span><span class="va">v6310</span>,<span class="va">v6330</span><span class="op">)</span>,
            <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">mun_id</span> <span class="op">%in%</span> <span class="va">bfs_nrs</span>,<span class="cn">NA</span>, <span class="va">.</span><span class="op">)</span><span class="op">)</span>

<span class="va">predicted_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_votes.html">predict_votes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"v6330"</span>,<span class="st">"v6310"</span><span class="op">)</span>,train<span class="op">=</span><span class="va">train</span>, test<span class="op">=</span><span class="va">testdata</span> ,exclude_votes <span class="op">=</span> <span class="cn">TRUE</span>, geovars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mun_id"</span>,<span class="st">"mun_name"</span> <span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Lade nötiges Paket: lattice</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attache Paket: 'caret'</span>
<span class="co">#&gt; The following object is masked from 'package:purrr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     lift</span>
<span class="co">#&gt; The following object is masked from 'package:plausi':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     RMSE</span>


<span class="co"># Vorhersagefehler</span>
<span class="va">predicted_results</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">vorlage</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>rmse<span class="op">=</span><span class="fu"><a href="../reference/RMSE.html">RMSE</a></span><span class="op">(</span><span class="va">pred</span>,<span class="va">real</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` ungrouping output (override with `.groups` argument)</span>
<span class="co">#&gt; Warning: `...` is not empty.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; We detected these problematic arguments:</span>
<span class="co">#&gt; * `needs_dots`</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; These dots only exist to allow future extensions and should be empty.</span>
<span class="co">#&gt; Did you misspecify an argument?</span>
<span class="co">#&gt; # A tibble: 2 x 2</span>
<span class="co">#&gt;   vorlage  rmse</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 v6310    1.61</span>
<span class="co">#&gt; 2 v6330    2.10</span></code></pre></div>
<div id="modelle-vergleichen" class="section level1">
<h1 class="hasAnchor">
<a href="#modelle-vergleichen" class="anchor"></a>Modelle vergleichen</h1>
<p>Plausi baut auf dem caret-package auf und lässt es somit zu, zwischen unzähligen Machine-Learning Algorithmen zu wählen und einfach umzustellen. Dies erleichtert es Modelle hinsichtlich Vorhersagegenauigkeit zu vergleichen.</p>
<p>Das ‘gvcEarth’ Model, ein MARS-Modell aus dem ‘earth’ package (Splines) wie auch ein svm-Modell schneiden am besten ab. Doch neben der Vorhersagegenauigkeit sollte das Modell auch möglichst robust gegenüber vermeintlich falschen Resultaten sein bzw. diese sollten die Vorhersage für eine Gemeinde nicht zu stark beeinflussen.</p>
<ul>
<li>gcvEarth offers the best accuracy, however seems to be prone to overfit in case of false results (real example: Rüti with switched yes and no-shares)</li>
<li>svmRadial is a bit less acurate on average however seems not to be affected by single false results</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Modelle die verglichen werden sollen</span>
<span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gcvEarth"</span>,<span class="st">"glmboost"</span>,<span class="st">"pls"</span>,<span class="st">"pcr"</span>,<span class="st">"svmRadial"</span><span class="op">)</span>

<span class="co"># Funktion für Vergleich unterschiedlicher Modelle</span>
<span class="va">test_models</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">votes</span>, <span class="va">train</span>,<span class="va">test</span>, <span class="va">model</span>,<span class="va">...</span><span class="op">)</span><span class="op">{</span>

  
<span class="fu">plausi</span><span class="fu">::</span><span class="fu"><a href="../reference/predict_votes.html">predict_votes</a></span><span class="op">(</span>votes <span class="op">=</span> <span class="va">votes</span>, 
                          train <span class="op">=</span> <span class="va">train</span>,
                          test<span class="op">=</span><span class="va">test</span>,
                           method <span class="op">=</span> <span class="va">model</span>,
                          exclude_votes <span class="op">=</span> <span class="cn">TRUE</span>,
                      
              <span class="va">...</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>mod<span class="op">=</span><span class="va">model</span><span class="op">)</span> 
 
 
  
<span class="op">}</span>

<span class="co">#Vergleich anhand der Vorhersage für drei Vorlagen</span>
<span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu">map_dfr</span><span class="op">(</span><span class="va">models</span>, <span class="op">~</span><span class="fu">test_models</span><span class="op">(</span>votes<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">train</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>,
                                        train<span class="op">=</span><span class="va">train</span>,
                                        test<span class="op">=</span><span class="va">testdata</span>,
                                        model<span class="op">=</span><span class="va">.x</span>,
                                        geovars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mun_id"</span>,<span class="st">"mun_name"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Vorhersagefehler je Modell pro Vorlage</span>
<span class="va">comparison</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">vorlage</span>,<span class="va">mod</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>rmse<span class="op">=</span><span class="fu"><a href="../reference/RMSE.html">RMSE</a></span><span class="op">(</span><span class="va">pred</span>,<span class="va">real</span>,na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; `summarise()` regrouping output by 'vorlage' (override with `.groups` argument)</span>
<span class="co">#&gt; Warning: `...` is not empty.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; We detected these problematic arguments:</span>
<span class="co">#&gt; * `needs_dots`</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; These dots only exist to allow future extensions and should be empty.</span>
<span class="co">#&gt; Did you misspecify an argument?</span>
<span class="co">#&gt; # A tibble: 15 x 3</span>
<span class="co">#&gt; # Groups:   vorlage [3]</span>
<span class="co">#&gt;    vorlage mod        rmse</span>
<span class="co">#&gt;    &lt;chr&gt;   &lt;chr&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 v6310   gcvEarth   1.63</span>
<span class="co">#&gt;  2 v6310   glmboost   1.88</span>
<span class="co">#&gt;  3 v6310   pcr        2.28</span>
<span class="co">#&gt;  4 v6310   pls        1.88</span>
<span class="co">#&gt;  5 v6310   svmRadial  2.11</span>
<span class="co">#&gt;  6 v6320   gcvEarth   2.25</span>
<span class="co">#&gt;  7 v6320   glmboost   2.75</span>
<span class="co">#&gt;  8 v6320   pcr        3.16</span>
<span class="co">#&gt;  9 v6320   pls        2.75</span>
<span class="co">#&gt; 10 v6320   svmRadial  1.99</span>
<span class="co">#&gt; 11 v6330   gcvEarth   2.16</span>
<span class="co">#&gt; 12 v6330   glmboost   3.07</span>
<span class="co">#&gt; 13 v6330   pcr        3.31</span>
<span class="co">#&gt; 14 v6330   pls        3.03</span>
<span class="co">#&gt; 15 v6330   svmRadial  2.13</span></code></pre></div>
</div>
<div id="streuung-der-vorhersagefehler-je-vorlage-in-der-vergangenheit" class="section level1">
<h1 class="hasAnchor">
<a href="#streuung-der-vorhersagefehler-je-vorlage-in-der-vergangenheit" class="anchor"></a>Streuung der Vorhersagefehler je Vorlage in der Vergangenheit</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># predict_single_vote("v6310", traindata=testdata, testprop = 0.1,geovars=c("mun_id","mun_name"))</span>


<span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_votes.html">predict_votes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">testdata</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">]</span>, train<span class="op">=</span><span class="va">testdata</span>, testprop <span class="op">=</span> <span class="fl">0.3</span>,geovars<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"mun_id"</span>,<span class="st">"mun_name"</span><span class="op">)</span><span class="op">)</span>


<span class="va">gem_pred</span> <span class="op">&lt;-</span> <span class="va">predictions</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>error<span class="op">=</span><span class="va">real</span><span class="op">-</span><span class="va">pred</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">vorlage</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rmse<span class="op">=</span><span class="fu"><a href="../reference/RMSE.html">RMSE</a></span><span class="op">(</span><span class="va">pred</span>,<span class="va">real</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>error_rmse<span class="op">=</span><span class="va">error</span><span class="op">/</span><span class="va">rmse</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>outlier<span class="op">=</span><span class="fu"><a href="../reference/is_outlier_double_mad.html">is_outlier_double_mad</a></span><span class="op">(</span><span class="va">error_rmse</span><span class="op">)</span><span class="op">)</span>
  

<span class="fu">ggplot</span><span class="op">(</span><span class="va">gem_pred</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">vorlage</span>, <span class="va">error</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_jitter</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="va">outlier</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_color_viridis_d</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="jaanteile_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="fehlerbereich-pro-gemeinde-in-vergangenheit" class="section level1">
<h1 class="hasAnchor">
<a href="#fehlerbereich-pro-gemeinde-in-vergangenheit" class="anchor"></a>Fehlerbereich pro Gemeinde in Vergangenheit</h1>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#  </span>
<span class="co"># </span>
<span class="co"># gem_pred %&gt;% </span>
<span class="co"># group_by(mun_id,mun_name) %&gt;% </span>
<span class="co"># summarize(range_lower=outlier_range(error_rmse)$lower,range_uppper=outlier_range(error_rmse)$upper)</span>


<span class="co"># </span>
<span class="co"># what &lt;- predictions %&gt;% </span>
<span class="co">#   mutate(error=real-pred)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#modelle-vergleichen">Modelle vergleichen</a></li>
      <li><a href="#streuung-der-vorhersagefehler-je-vorlage-in-der-vergangenheit">Streuung der Vorhersagefehler je Vorlage in der Vergangenheit</a></li>
      <li><a href="#fehlerbereich-pro-gemeinde-in-vergangenheit">Fehlerbereich pro Gemeinde in Vergangenheit</a></li>
      </ul>
</div>
      <!-- codefund -->
   <!--<div id="codefund"><!-- fallback content </div> -->
<!--  <script src="https://codefund.app/properties/148/funder.js" async="async"></script>-->
  </div>

</div>



      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#000000 !important;background-color:#FFFFFF !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 0px 9px !important;font-size: 17px !important;letter-spacing:-0.08px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Lato', sans-serif !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style>
<link href="https://fonts.googleapis.com/css?family=Lato&amp;subset=latin,latin-ext" rel="stylesheet">
<a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/politanch"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span></a>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
