<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Auffällige Stimmbeteiligungswerte identifizieren • plausi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/lumen/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Auffällige Stimmbeteiligungswerte identifizieren">
<meta property="og:description" content="plausi">
<meta name="twitter:card" content="summary">
<meta name="theme-color" content="#293c55">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><script>
     (adsbygoogle = window.adsbygoogle || []).push({
          google_ad_client: "ca-pub-7425245790017381",
          enable_page_level_ads: true
     });
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plausi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0.9999</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/jaanteile.html">Vorhersage Ja-Anteile</a>
    </li>
    <li>
      <a href="../articles/model_selection.html">model_selection</a>
    </li>
    <li>
      <a href="../articles/stimmbeteiligung.html">Auffällige Stimmbeteiligungswerte identifizieren</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="stimmbeteiligung_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Auffällige Stimmbeteiligungswerte identifizieren</h1>
            
      
      
      <div class="hidden name"><code>stimmbeteiligung.Rmd</code></div>

    </div>

    
    
<p>Um Anomalien in der Stimmbeteiligung ausfindig zu machen bietet das plausi package Funktionen, die es erlauben die Differenz zwischen der Beteiligungswerten verschiedener Vorlagen systematisch über alle Zählkreise hinweg zu vergleichen.</p>
<p>In der Regel bestehen relativ klare Muster - gewisse Vorlagen mobilisieren stärker als andere. Hierbei ist das Thema der Vorlage, die Intensität des Abstimmungskampfes wichtig als auch die Bezugsebene des Geschäfts. Kantonale Vorlagen weissen i.d.R. eine tiefere Beteiligung aus als nationale Vorlagen, die am selben Abstimmungstag zur Abstimmung kommen.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">plausi</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/politanch/swissdd">swissdd</a></span><span class="op">)</span></code></pre></div>
<pre><code>## ************************************************************</code></pre>
<pre><code>## *                       swissdd 1.0.3                      *</code></pre>
<pre><code>## *                  developed by politan.ch                 *</code></pre>
<pre><code>## *                                                          *</code></pre>
<pre><code>## *                     Data sources:                        *</code></pre>
<pre><code>## *                Federal Statistical Office                *</code></pre>
<pre><code>## *                 https://www.bfs.admin.ch/                *</code></pre>
<pre><code>## *                                                          *</code></pre>
<pre><code>## *                      Swissvotes                          *</code></pre>
<pre><code>## *                  https://swissvotes.ch/                  *</code></pre>
<pre><code>## *                                                          *</code></pre>
<pre><code>## ************************************************************</code></pre>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.2     v purrr   0.3.4
## v tibble  3.0.2     v dplyr   1.0.0
## v tidyr   1.1.0     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div id="datenbezug" class="section level1">
<h1 class="hasAnchor">
<a href="#datenbezug" class="anchor"></a>Datenbezug</h1>
<p>Via swissdd package können die Daten für einen Abstimmungstermin der Wahl bezogen werden.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Sys.getenv("https_proxy")</span>
<span class="co"># Sys.setenv(https_proxy="")</span>

<span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">swissdd</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/swissdd/man/get_nationalvotes.html">get_nationalvotes</a></span><span class="op">(</span>votedates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"2020-09-27"</span><span class="op">)</span><span class="op">)</span>

<span class="va">combinations</span> <span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">id</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">data_wide</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">canton_name</span>,<span class="va">mun_name</span>, <span class="va">mun_id</span>, <span class="va">stimmbeteiligungInProzent</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from<span class="op">=</span><span class="va">id</span>,values_from<span class="op">=</span><span class="va">stimmbeteiligungInProzent</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_if</a></span><span class="op">(</span><span class="va">is.character</span>,<span class="va">as.factor</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">canton_name</span><span class="op">==</span><span class="st">"Zürich"</span><span class="op">)</span>

<span class="fu"><a href="../reference/cross_fun.html">cross_fun</a></span><span class="op">(</span><span class="va">data_wide</span>, <span class="va">combinations</span><span class="op">$</span><span class="va">V1</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,<span class="va">combinations</span><span class="op">$</span><span class="va">V2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,geo_cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"canton_name"</span>,<span class="st">"mun_name"</span>,<span class="st">"mun_id"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Warning: `...` is not empty.
## 
## We detected these problematic arguments:
## * `needs_dots`
## 
## These dots only exist to allow future extensions and should be empty.
## Did you misspecify an argument?</code></pre>
<pre><code>## # A tibble: 163 x 5
##    canton_name mun_name           mun_id combination difference
##    &lt;fct&gt;       &lt;fct&gt;              &lt;fct&gt;  &lt;chr&gt;            &lt;dbl&gt;
##  1 Zürich      Aeugst am Albis    1      6310_6330        0.632
##  2 Zürich      Affoltern am Albis 2      6310_6330        0.586
##  3 Zürich      Bonstetten         3      6310_6330        0.932
##  4 Zürich      Hausen am Albis    4      6310_6330        0.588
##  5 Zürich      Hedingen           5      6310_6330        0.833
##  6 Zürich      Kappel am Albis    6      6310_6330        0.383
##  7 Zürich      Knonau             7      6310_6330        0.533
##  8 Zürich      Maschwanden        8      6310_6330        1.32 
##  9 Zürich      Mettmenstetten     9      6310_6330        0.446
## 10 Zürich      Obfelden           10     6310_6330        0.593
## # ... with 153 more rows</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_differences.html">get_differences</a></span><span class="op">(</span><span class="va">data_wide</span>,<span class="va">combinations</span><span class="op">$</span><span class="va">V1</span>,<span class="va">combinations</span><span class="op">$</span><span class="va">V2</span>,geo_cols<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"canton_name"</span>,<span class="st">"mun_name"</span>,<span class="st">"mun_id"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">diff2</span> <span class="op">&lt;-</span> <span class="va">diff</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">combination</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>outlier<span class="op">=</span><span class="fu"><a href="../reference/is_outlier_double_mad.html">is_outlier_double_mad</a></span><span class="op">(</span><span class="va">difference</span>,thres<span class="op">=</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">diff2</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">combination</span>, <span class="va">difference</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_violin</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">geom_jitter</span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.3</span>, <span class="fu">aes</span><span class="op">(</span>color<span class="op">=</span><span class="va">outlier</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">theme_minimal</span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu">scale_fill_viridis_d</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="stimmbeteiligung_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div id="welche-vorlagen-sind-auffällig" class="section level1">
<h1 class="hasAnchor">
<a href="#welche-vorlagen-sind-auff%C3%A4llig" class="anchor"></a>Welche Vorlagen sind auffällig?</h1>
<p>Um herauszufinden welche der Vorlagen dazu führen, dass Kombinationen aufällig sind:</p>
<ul>
<li>Extrahiere Vorlage-Ids aus Kombinationen</li>
<li>Formattiere Daten um um zählen zu können wie oft eine Vorlage in auffälligen Kombinationen vorkommt.</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">problem_vorlagen</span> <span class="op">&lt;-</span> <span class="va">diff2</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">combination</span>,into<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"vorlage1"</span>,<span class="st">"vorlage2"</span><span class="op">)</span>, sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">outlier</span><span class="op">==</span><span class="cn">TRUE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span> cols <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">canton_name</span>,<span class="va">mun_name</span>,<span class="va">mun_id</span>, <span class="va">difference</span>, <span class="va">outlier</span><span class="op">)</span>, names_to<span class="op">=</span><span class="st">"vorlage"</span>, values_to<span class="op">=</span><span class="st">"vorlage_id"</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">mun_name</span>,<span class="va">mun_id</span>,<span class="va">vorlage_id</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` regrouping output by 'mun_name', 'mun_id' (override with `.groups` argument)</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#datenbezug">Datenbezug</a></li>
      <li><a href="#welche-vorlagen-sind-auff%C3%A4llig">Welche Vorlagen sind auffällig?</a></li>
      </ul>
</div>
      <!-- codefund -->
   <!--<div id="codefund"><!-- fallback content </div> -->
<!--  <script src="https://codefund.app/properties/148/funder.js" async="async"></script>-->
  </div>

</div>



      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<style>.bmc-button img{width: 27px !important;margin-bottom: 1px !important;box-shadow: none !important;border: none !important;vertical-align: middle !important;}.bmc-button{line-height: 36px !important;height:37px !important;text-decoration: none !important;display:inline-flex !important;color:#000000 !important;background-color:#FFFFFF !important;border-radius: 3px !important;border: 1px solid transparent !important;padding: 0px 9px !important;font-size: 17px !important;letter-spacing:-0.08px !important;box-shadow: 0px 1px 2px rgba(190, 190, 190, 0.5) !important;-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;margin: 0 auto !important;font-family:'Lato', sans-serif !important;-webkit-box-sizing: border-box !important;box-sizing: border-box !important;-o-transition: 0.3s all linear !important;-webkit-transition: 0.3s all linear !important;-moz-transition: 0.3s all linear !important;-ms-transition: 0.3s all linear !important;transition: 0.3s all linear !important;}.bmc-button:hover, .bmc-button:active, .bmc-button:focus {-webkit-box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;text-decoration: none !important;box-shadow: 0px 1px 2px 2px rgba(190, 190, 190, 0.5) !important;opacity: 0.85 !important;color:#000000 !important;}</style>
<link href="https://fonts.googleapis.com/css?family=Lato&amp;subset=latin,latin-ext" rel="stylesheet">
<a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/politanch"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"><span style="margin-left:5px">Buy me a coffee</span></a>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
